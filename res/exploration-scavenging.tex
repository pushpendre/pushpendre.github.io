\documentclass[preview,border={30 30 30 30}]{standalone}
\usepackage{amsfonts,amsmath,amssymb,amsthm,graphicx,url,listings,booktabs}
\usepackage{xcolor}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=2
}
\lstset{style=mystyle}
% ------ MACROS -------- %
\usepackage{algorithmic}
\newcommand{\myalg}[1]{\fbox{\parbox{\linewidth}{\begin{algorithmic}#1\end{algorithmic}}}}
\newcommand{\detour}[1]{\myalg{\STATE \textsc{Detour}\\\hrulefill
\STATE #1}}

\newcommand{\ta}{\theta}
\newcommand{\h}{\hat{\theta}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\mycol}[1]{\multicolumn{2}{c}{\textbf{#1}}}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan,
}
\begin{document}
\textbf{Exploration Scavenging in comparison to other off-policy estimators.}~\\

Exploration Scavenging is an off-policy estimator for contextual bandits.
Many off-policy estimators for contextual bandits exist, such as,
IPS~\cite{rosenbaum1983central},
SNIPS~\cite{swaminathan2015self},
DR~\cite{dudik2014doubly}, Direct Matching, and
Exploration Scavenging~\cite{langford2008exploration}. These Off-Policy estimators have different operating conditions and also different bias/variance.

\begin{table}[htbp]
  \centering
  \caption{Various Off-Policy Evaluators}
  \begin{tabular}{rllll}
    \toprule
                       & \textbf{Needs Non-Ctx}  & \textbf{Requires}   & \textbf{Is }      & \textbf{Variance or} \\
    \textbf{Estimator} & \textbf{Logging Policy} & \textbf{Propensity} & \textbf{Unbiased} & \textbf{Conc. Bound} \\
    \midrule
    ES                 & Yes                     & No                  & Yes               & $\sum_a \sqrt{\frac{ \log (kT/\delta)}{T_a}}$              \\
    IPS                & No                      & Yes                 & Yes               & TODO              \\
    SNIPS              & No                      & Yes                 & No                & TODO              \\
    DR                 & No                      & Yes                 & Yes               & TODO              \\
    \bottomrule
  \end{tabular}
  \label{tab:ope}
\end{table}


\paragraph{Exploration Scavenging} Assume we are given a dataset $\mathcal{D}$ containing
triples of $(x=\text{feature}, a=\text{action}, r=\text{reward})$ generated by following
some logging policy, then the exploration scavenging policy paper's theorem 2 tells us that

For any distribution $D$ over (x, r) and any exploration policy $\pi$ such that
1) Let the number of times each action is
chosen during $T$ trials be $T_a$. $T_a$  is a random variable.  The first condition is
that $P(T_a > 0) = 1$. 2) $\pi$ chooses $a_t$ independent of $x_t$, in other words, the
logging policy is non-contextual, but the logging policy can also be non-stationary!
Then the $ES$ OPE -- defined below -- is an unbiased estimator for the value of the new policy $h$
\[ \mathbb{E}_{\{(x,r) \sim D\}}\big( \sum_{t=1}^{T} \frac{r_{t,a} \mathbb{I}(h(x) = a)}{T_{a_t}}
  \big)
\]

The crucial requirements in the proof are that
\begin{enumerate}
\item $\mathbb{I}(h(x_t)=1)$ is independent of time.
\item $\mathbb{I}(h(x_t)=1)$ is independent of $r_{t,a}$.
\item $r_{t,a}$ is independent of time.
\end{enumerate}

\paragraph{Comparing the different variance of different estimators}
TODO

It will be good to know that how much does IPS or SNIPS buy us in the regime where ES can work?

IPS is analyzed in general in \url{http://alekhagarwal.net/bandits_and_rl/off_policy.pdf}. I'll like to know how does IPS perform given a non-stationary non-contextual logging policy? What is the value of additionally knowing exact propensities of an evolving logging policy? The SNIPS and DR are analyzed in their respective papers. How well do they perform?

\begin{thebibliography}{widest entry}
\bibitem[Rosenbaum 1983]{rosenbaum1983central} ``The central role of the propensity score in
  observational studies for causal effects.'' Rosenbaum, Paul R. and Rubin, Donald
  B. Biometrika (1983)
\bibitem[Langford 2008]{langford2008exploration} ``Exploration scavenging.'' Langford, John
  and Strehl, Alexander and Wortman, Jennifer. ICML (2008)
\bibitem[Swaminathan 2015]{swaminathan2015self} ``The self-normalized estimator for
  counterfactual learning.'' Swaminathan, Adith and Joachims, Thorsten. Neurips (2015)
\bibitem[Dudik 2014]{dudik2014doubly} ``Doubly robust policy evaluation and optimization.''
  Dud{\'\i}k, Miroslav and Erhan, Dumitru and Langford, John and Li, Lihong. Statistical
  Science (2014)
\end{thebibliography}

\end{document}


@article{rosenbaum1983central,
  title={The central role of the propensity score in observational studies for causal effects},
  author={Rosenbaum, Paul R and Rubin, Donald B},
  journal={Biometrika},
  volume={70},
  number={1},
  pages={41--55},
  year={1983},
  publisher={Oxford University Press}
}

@inproceedings{langford2008exploration,
  title={Exploration scavenging},
  author={Langford, John and Strehl, Alexander and Wortman, Jennifer},
  booktitle={Proceedings of the 25th international conference on Machine learning},
  pages={528--535},
  year={2008}
}


@inproceedings{swaminathan2015self,
  title={The self-normalized estimator for counterfactual learning},
  author={Swaminathan, Adith and Joachims, Thorsten},
  booktitle={Neurips},
  pages={3231--3239},
  year={2015}
}

@article{dudik2014doubly,
  title={Doubly robust policy evaluation and optimization},
  author={Dud{\'\i}k, Miroslav and Erhan, Dumitru and Langford, John and Li, Lihong and others},
  journal={Statistical Science},
  volume={29},
  number={4},
  pages={485--511},
  year={2014},
  publisher={Institute of Mathematical Statistics}
}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
